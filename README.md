# 電子書自動下載與合併 PDF 工具

## 專案簡介

本工具用於自動下載電子書的圖片，並將每個章節的圖片合併成 PDF 檔案。  
下載的圖片與生成的 PDF 會分別存放於不同的資料夾，方便管理與檢查。

---

## 功能說明

1. **圖片下載**

   - 根據使用者輸入的章節起始頁數，自動下載對應的圖片。
   - 圖片存放於 `output/images/{章節名稱}/` 資料夾中。
   - 支援自動處理圖片網址規律與 Cookie 驗證。

2. **PDF 合併**

   - 將每個章節的圖片合併成 PDF。
   - PDF 檔案存放於 `output/PDF/` 資料夾中。
   - 自動讀取 `output/images/` 資料夾內的所有章節資料夾，動態生成 PDF。

3. **靈活操作**
   - 可選擇是否需要下載圖片，僅進行 PDF 合併。
   - 支援動態新增或刪除章節資料夾，無需修改程式碼。

---

## 專案結構

```
your_project/
│
├── main.py                # 主程式
├── modules/
│   ├── __init__.py
│   ├── download_images.py # 負責圖片下載
│   ├── merge_pdf.py       # 負責合併 PDF
│   └── utils.py           # 共用工具函式
├── cooke.json             # Cookie 檔案
├── .env                   # 圖片網址模板
├── requirements.txt       # 依賴套件
└── output/
    ├── images/            # 存放下載的圖片
    │   ├── chapter1/
    │   └── ...
    └── PDF/               # 存放合併後的 PDF
        ├── chapter1.pdf
        └── ...
```

---

## 使用說明

### 安裝環境

1. 安裝 Python 3.7 或以上版本。
2. 安裝必要套件：

   ```bash
   pip install -r requirements.txt
   ```

### 準備檔案

- **Cookie 檔案**：
  將登入後的 Cookie 匯出為 cooke.json，放置於專案根目錄。
  Cookie 匯出方式可參考瀏覽器開發者工具。

- **圖片網址模板**：在 .env 檔案中填入圖片網址模板，格式如下：
  https://streaming-ebook.books.com.tw/V1.0/Streaming/book/5DD477/10279858/item/image/i-{page}.jpg?checksum=...
  {page} 為頁數變數，程式會自動替換為三位數頁碼。

### 執行程式

#### 執行主程式：

```
python main.py
```

#### 按照指示操作：

1. 選擇是否需要下載圖片
   若選擇下載圖片，依序輸入每個章節的起始頁數與最後一頁頁數
2. 圖片下載完成後，檢查 output/images/ 資料夾內的圖片是否正確。
3. 確認無誤後，程式會自動合併 PDF，生成的 PDF 存放於 output/PDF/ 資料夾。

## 注意事項

### Cookie 有效期

Cookie 可能會過期，若遇到下載失敗，請重新登入並匯出新的 Cookie。

### 圖片網址規律

確保 .env 檔案中的圖片網址模板正確，並包含 {page} 作為頁數變數。

### 資料夾結構

圖片與 PDF 的輸出資料夾結構為固定格式，請勿手動更改。

## 錯誤處理

若下載過程中出現錯誤，程式會顯示錯誤訊息，請檢查網路連線或 Cookie 是否有效。

### 範例操作

啟動程式後，選擇是否需要下載圖片：

```
是否需要下載圖片？(y/n)：y

輸入章節的起始頁數：

第 1 章開始頁數：1
第 2 章開始頁數：20
第 3 章開始頁數：50
（空白代表結束）

輸入最後一頁的頁數：

請輸入最後一頁的頁數：100

圖片下載完成後，檢查 output/images/ 資料夾內的圖片，確認無誤後按 Enter 繼續。

PDF 合併完成，檔案存放於 output/PDF/ 資料夾。
```

## 授權

本專案僅供學術與個人用途，請勿用於商業用途或違反相關法律規範。
